{% extends "layout.html" %}

{% block title %}
   Add a book
{% endblock %}

{% block main %}
    <h2>Search for a Book</h2>
    <form method="get" action="/add_book" autocomplete="off">
        <input class="form-control mx-auto w-auto" name="q" placeholder="Enter book title" type="text" value="{{ request.args.q }}">
        <button class="btn btn-primary" type="submit">Search</button>
    </form>
    
    {% if results %}
        <h3>Search Results:</h3>
        <div class="results">
            {% for result in results %}
                <div class="book">
                    <img src="{{ result.image }}" alt="Book cover">
                    <h4>{{ result.title }}</h4>
                    <p>{{ result.author }}</p>
                    <form method="post" action="/add_book">
                        <input type="hidden" name="book_title" value="{{ result.title }}">
                        <input type="hidden" name="author" value="{{ result.author }}">
                        <select class="form-control mx-auto w-auto" name="status">
                            <option value="to_read">To read</option>
                            <option value="currently_reading">Currently reading</option>
                            <option value="read">Read</option>
                        </select>
                        <button class="btn btn-success" type="submit">Add</button>
                    </form>
                </div>
            {% endfor %}
        </div>
    {% endif %}
{% endblock %}

    <!-- Auto-hide the flash message after three seconds -->
    <script>
        setTimeout(() => {
            const flashMessage = document.getElementById('flash-message');
            if (flashMessage) {
                flashMessage.classList.add('fade-out');
                setTimeout(() => flashMessage.remove(), 500);
            }
        }, 3000);
    </script>
